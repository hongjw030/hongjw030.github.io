---
title: "자바스크립트의 closure, 클로저란?"
mainCategory: "study"
subCategory: "study_cs"
description: "기술면접 단골 질문, js의 클로저에 대해 알아보자."
coverImg: "/assets/study/cs/3_1.png"
---


## 오늘의 기술면접 질문

####  자바스크립트의 클로저에 대해 말해주세요.

이것도 꽤 단골질문인게, 클로저가 자바스크립트의 특징 중 하나기 때문.

근데 솔직히.. 정말 어렵다!! 아무리 봐도 이해가 안되는 클로저 개념. 관련된 개념 (lexical environment, execution context 등등..)이 너무 많기 때문이다. 이 포스팅 안에 관련 개념들을 다 설명하는 건 너무 힘들기도 하고, 아직 나도 잘 이해가 안돼서...

일단 이번에는 기술 면접에 대답하고 실제 플젝에 적용해볼 수 있을 정도로는 공부해보자.

![image](/assets/study/cs/3_1.png)
(사진은 클로저 예시.)

***

## js의 클로저, closure 파헤치기

### 1. 클로저가 뭔데?

js의 클로저는 `함수와 함수가 선언된 어휘 환경(lexical environment) 의 조합` 을 말한다. 

외부함수와 그 내부에 중첩된 함수가 있을 때, `외부 함수의 생명주기가 끝났음에도 불구하고 내부의 중첩 함수가 외부함수 안에 있는 지역 변수를 참조할 수 있는데 이러한 중첩함수`를 클로저라 한다.

뭔... 뭔소리야. 그럼 어휘 환경, Lexical environment가 뭘까?

### 2. Lexical environment가 뭔가?

자바스크립트에서의 Lexical environment란, `변수 및 함수가 선언되고 런타임 중에 존재하는 컨텍스트`를 말한다. 간단히 말하자면 코드가 작성되고 실행되는 환경 그 자체를 말한다.

예를 들어 아래 코드를 보면..

```javascript
function aaa(){...}
function bbb(){aaa(); ...}

aaa();
bbb();
```

함수는 자기 자신이 어디서 호출되든 신경 쓰지 않고 `정의되는 환경`에만 따라서 자신의 상위 스코프를 기억한다.

위의 코드에서 `aaa` 함수는 전역 코드에 정의되었기 때문에, 함수 `bbb` 안에서 호출되든 말든 신경 안쓰고 자신의 상위 스코프로 전역 환경을 기억하게 된다.

즉 lexical environment에는 함수가 실행될 때 그 함수의 상위 스코프 + 함수의 스코프를 말한다.. (각각 `환경 레코드`와 `외부 렉시컬 환경에 대한 참조`라고 한다고는 하는데 너무 딥해져서 그냥 축약했다.)

### 3. 그렇다면?!

> 외부함수와 그 내부에 중첩된 함수가 있을 때, `외부 함수의 생명주기가 끝났음에도 불구하고 내부의 중첩 함수가 외부함수 안에 있는 지역 변수를 참조할 수 있는데 이러한 중첩함수`를 클로저라 한다.

이 정의에 대해 다시 보자...

내부에 중첩된 함수는 자신의 상위 스코프 (외부 함수의 내부)를 기억하기 때문에 이를 참조할 수 있게 된다.

예시를 한 번 보자. (**모던자바스크립트 딥다이브 예시를 참고했습니다.**)

```javascript
// 외부 함수
const counter = function(){
  let num = 0;
  // 클로저
  return {
    increase(){ return ++num},
    decrease(){ return --num}
    };
}

console.log(counter.increase());
console.log(counter.decrease());

console.log(increase)
```

클로저 함수는 외부 함수 안에 있는 num이라는 지역변수를 참조해 값을 바꾸는 것을 볼 수 있다.

사실 자바스크립트의 모든 함수는 상위 스코프를 기억하기 때문에 이론적으론 모든 함수가 클로저긴 하지만, 보통은 상위 스코프의 식별자를 참조하면서, 중첩함수가 외부함수의 외부로 반환되어 외부함수보다 중첩함수의 생명주기가 긴 경우의 중첩함수를 클로저라 한다. 

자바스크립트는 함수를 일급 객체로 취급하는 함수형 프로그래밍 언어이다. 클로저는 이런 함수형 프로그래밍 언어에서 등장하는 개념이다. (즉, js 고유 특징이 아니란 소리.)

### 4. 클로저의 장점? (= 클로저를 왜 쓰는지?)

클로저는 정보 은닉, 캡슐화에 도움을 주고 전역변수를 남용하지 않게 해준다.

이게 뭔 장점인가 싶겠지만...

자바 언어를 공부하다 오신 분들은 알겠지만 (본인이 자바 공부하다 넘어와서 다른 언어로는 뭔 예시를 들어야 할지 모르겠음) 중요한 값을 담은 변수는 함부로 값이 변하지 않게 setter 함수만으로 조작하고 값을 참조하려면 setter함수로만 가능하게끔 구현할 수 있다.

클로저를 이용하면 값이 의도치않게 오염될 수 있는 전역변수가 아니라, 외부 함수 안의 지역변수를 참조하여 값을 사용하기 때문에 지역 변수 값을 안전하게 숨기고 의도치 않게 값이 바뀌는 걸 막을 수가 있다. 

***

## 총정리

#### Q. 자바스크립트의 클로저에 대해 말해주세요.

A. 
클로저는 자바스크립트가 함수를 일급 객체로 보는 함수형 프로그래밍 언어라 생긴 개념으로, 함수와 함수의 렉시컬 환경의 조합을 의미합니다. 

외부 함수와 중첩된 함수가 있을 때 중첩된 함수가 자신의 상위 스코프인 외부함수의 식별자를 참조하면서, 외부함수보다 중첩함수의 생명주기가 더 긴 경우 그 중첩함수를 클로저라 합니다.

클로저는 데이터를 은닉시켜주고 캡슐화하는 장점이 있습니다.